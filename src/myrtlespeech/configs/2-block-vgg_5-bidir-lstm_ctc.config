speech_to_text {
  alphabet: "_abcdefghijklmnopqrstuvwxyz '."

  pre_process_step {
    stage: TRAIN_AND_EVAL;
    mfcc {
      numcep: 83;
      winlen: 0.025;
      winstep: 0.020;
    }
  }

  encoder_decoder {
    encoder {
      cnn_rnn_encoder {
        vgg {
          vgg_config: B;
          batch_norm: true;
          use_output_from_block: TWO;
        }

        rnn {
          rnn_type: LSTM;
          hidden_size: 1024;
          num_layers: 5;
          bias: true;
          bidirectional: true;
          forget_gate_bias {
            value: 1.0;
          }
        }
      }
    }

    decoder {
      fully_connected {
        num_hidden_layers: 0;
      }
    }
  }

  ctc_loss {
    blank_index: 0;
    reduction: MEAN;
  }

  ctc_beam_decoder {
    blank_index: 0;
    beam_width: 16;
    prune_threshold: 0.001;
    separator_index {
      value: 27;
    }
    language_model {
      no_lm { }
    }
    word_weight: 2.0;
  }
}

train_config {
  batch_size: 128;
  epochs: 1;
  adam {
    learning_rate: 0.0009;
  }
  dataset {
    librispeech {
      root: "~/Data/";
      subset: TRAIN_CLEAN_100;
      max_secs {
        value: 16.7;
      }
    }
  }
  shuffle_batches_before_every_epoch: True;
}

eval_config {
  batch_size: 128;
  dataset {
    librispeech {
      root: "~/Data/";
      subset: DEV_CLEAN;
    }
  }
}
